\doxysection{/home/arash/\+Projects/\+Py\+Torch\+CPP/main.cpp}
\hypertarget{main_8cpp_source}{}\label{main_8cpp_source}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ <torch/script.h>}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00005}00005\ \textcolor{keywordtype}{int}\ main()\ \{}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00006}00006\ \ \ \ \ \textcolor{comment}{//\ Load\ the\ model}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00007}00007\ \ \ \ \ torch::jit::script::Module\ model\ =\ torch::jit::load(\textcolor{stringliteral}{"{}/home/arash/PycharmProjects/PyTorchTest/ann\_lagged\_model.pt"{}});}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00008}00008\ \ \ \ \ model.eval();}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00010}00010\ \ \ \ \ \textcolor{comment}{//\ Initial\ known\ values\ (length\ =\ 20)}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00011}00011\ \ \ \ \ std::vector<float>\ history\ =\ \{}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00012}00012\ \ \ \ \ \ \ \ \ 0.1,\ 0.2,\ 0.0,\ -\/0.1,\ -\/0.2,\ -\/0.3,\ -\/0.1,\ 0.0,\ 0.2,\ 0.3,}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00013}00013\ \ \ \ \ \ \ \ \ 0.5,\ 0.6,\ 0.4,\ 0.3,\ 0.2,\ 0.1,\ -\/0.1,\ -\/0.2,\ -\/0.1,\ 0.0}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00014}00014\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00016}00016\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ horizon\ =\ 30;\ \textcolor{comment}{//\ how\ many\ steps\ ahead\ to\ predict}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00017}00017\ \ \ \ \ std::vector<float>\ predictions;}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00019}00019\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ horizon;\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00020}00020\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ last\ 20\ values\ into\ a\ tensor}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00021}00021\ \ \ \ \ \ \ \ \ torch::Tensor\ input\_tensor\ =\ torch::from\_blob(history.data(),\ \{1,\ 20\},\ torch::kFloat32).clone();}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Predict\ the\ next\ value}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00024}00024\ \ \ \ \ \ \ \ \ at::Tensor\ output\ =\ model.forward(\{input\_tensor\}).toTensor();}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ next\_value\ =\ output.item<\textcolor{keywordtype}{float}>();}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00026}00026\ \ \ \ \ \ \ \ \ predictions.push\_back(next\_value);}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00027}00027\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Slide\ the\ window:\ drop\ the\ first,\ append\ the\ prediction}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00029}00029\ \ \ \ \ \ \ \ \ history.erase(history.begin());}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00030}00030\ \ \ \ \ \ \ \ \ history.push\_back(next\_value);}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00031}00031\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{comment}{//\ Print\ results}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00034}00034\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Predicted\ "{}}\ <<\ horizon\ <<\ \textcolor{stringliteral}{"{}\ future\ steps:\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00035}00035\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ predictions.size();\ ++i)\ \{}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00036}00036\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Step\ "{}}\ <<\ i\ +\ 1\ <<\ \textcolor{stringliteral}{"{}:\ "{}}\ <<\ predictions[i]\ <<\ std::endl;}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00037}00037\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00039}00039\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{main_8cpp_source_l00040}00040\ \}}

\end{DoxyCode}
